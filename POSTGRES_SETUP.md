# Настройка PostgreSQL на Render

## Проблема
На Render файловая система ephemeral - все файлы удаляются при каждом рестарте. SQLite база данных хранится в файле, поэтому она теряется.

## Решение
Использовать PostgreSQL, который Render предоставляет бесплатно и который сохраняется между рестартами.

## Шаги настройки

### 1. Создайте PostgreSQL базу данных на Render

1. Зайдите на https://dashboard.render.com
2. Нажмите "New +" → "PostgreSQL"
3. Заполните форму:
   - **Name**: `vocabulary-db` (или любое другое имя)
   - **Database**: `vocabulary` (или любое другое имя)
   - **User**: оставьте по умолчанию
   - **Region**: выберите ближайший регион
   - **PostgreSQL Version**: последняя версия
   - **Plan**: **Free** (бесплатный план)
4. Нажмите "Create Database"

### 2. Получите DATABASE_URL

После создания базы данных:
1. Откройте созданную базу данных
2. В разделе "Connections" найдите **Internal Database URL**
3. Скопируйте этот URL (он выглядит как `postgresql://user:password@host:port/database`)

### 3. Добавьте DATABASE_URL в переменные окружения бота

1. Откройте ваш Background Worker сервис на Render
2. Перейдите в раздел "Environment"
3. Добавьте новую переменную:
   - **Key**: `DATABASE_URL`
   - **Value**: вставьте скопированный Internal Database URL
4. Нажмите "Save Changes"

### 4. Обновите requirements.txt

Убедитесь, что в `requirements.txt` есть:
```
psycopg2-binary>=2.9.9
```

### 5. Перезапустите бота

После добавления переменной окружения Render автоматически перезапустит бота. Или вы можете сделать это вручную:
- Откройте ваш Background Worker сервис
- Нажмите "Manual Deploy" → "Deploy latest commit"

## Проверка

После перезапуска бота:
1. Проверьте логи бота - должно быть сообщение "Используется PostgreSQL"
2. Попробуйте добавить слова командой `/add_words`
3. Перезапустите бота - слова должны сохраниться!

## Важно

- **Internal Database URL** используется для подключения изнутри Render (между сервисами)
- **External Database URL** используется для подключения извне (с вашего компьютера)
- Для бота используйте **Internal Database URL**

## Локальная разработка

Для локальной разработки ничего менять не нужно - код автоматически использует SQLite, если `DATABASE_URL` не установлен.

